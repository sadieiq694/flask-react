(this["webpackJsonpreact-frontend"]=this["webpackJsonpreact-frontend"]||[]).push([[0],{220:function(t,e,a){},399:function(t,e,a){"use strict";a.r(e);var n=a(1),r=a.n(n),o=a(42),c=a.n(o),i=(a(220),a(9)),l=a(10),s=a(12),u=a(11),p=a(59),h=a(13),d=h.g().domain(["node","container","pod","service","deployment"]).range(["https://cdn2.iconfinder.com/data/icons/mixd/512/21_kubernetes-512.png","https://cdn4.iconfinder.com/data/icons/vectory-symbols/40/hexagon-512.png","https://image.flaticon.com/icons/svg/73/73326.svg","https://static.thenounproject.com/png/32460-200.png","https://cdn1.iconfinder.com/data/icons/materia-arrows-symbols-vol-9/24/018_343_insignia_badge_shape_triangle-512.png"]),m=h.g().domain(["scheduled on","runs","references","targets","calls","owns","backs","points to"]).range(["red","black","blue","pink","green","brown","yellow","orange"]),f=function(t){Object(s.a)(a,t);var e=Object(u.a)(a);function a(){var t;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))).createGraph=function(){var e=1e3,a=t.props.links.map((function(t){return Object.assign({},t)})),n=t.props.nodes.map((function(t){return Object.assign({},t)})),r=function(t){return h.a().subject((function(e){return t.find(e.x,e.y)})).on("start",(function(e){e.active||t.alphaTarget(.3).restart(),e.subject.fx=e.subject.x,e.subject.fy=e.subject.y})).on("drag",(function(t){t.subject.fx=t.x,t.subject.fy=t.y})).on("end",(function(e){e.active||t.alphaTarget(0),e.subject.fx=null,e.subject.fy=null}))},o=h.d(n).force("link",h.b(a).id((function(t){return t.id}))).force("charge",h.c().strength(-200)).force("x",h.e()).force("y",h.f()),c=h.h("svg").attr("viewBox",[-500,-200,e,400]),i=(c.append("defs").append("marker").attr("id","arrowhead").attr("viewBox","-0 -5 10 10").attr("refX",23).attr("refY",0).attr("orient","auto").attr("markerWidth",4).attr("markerHeight",4).attr("xoverflow","visible").append("svg:path").attr("d","M 0,-5 L 10 ,0 L 0,5").attr("fill","black").style("stroke","none"),c.append("g").attr("stroke","#999").attr("stroke-opacity",.6).selectAll("line").data(a).join("line").style("stroke",(function(t){return m(t.type)})).attr("stroke-width",3).attr("marker-end","url(#arrowhead)")),l=c.append("g").attr("class","text").selectAll("text").data(n).enter().append("text").attr("font-family","sans-serif").attr("font-size",15).text((function(t){return t.name})).call(r(o)),s=c.append("g").attr("class","image").selectAll("image").data(n).enter().append("image").attr("xlink:href",(function(t){return d(t.group)})).attr("width",30).attr("height",30).call(r(o)),u=c.selectAll(".legend").data(d.domain()).enter().append("g").attr("transform",(function(t,e){return"translate(".concat(350,",").concat(25*e-50,")")}));u.append("image").attr("xlink:href",d).attr("width",20).attr("height",20),u.append("text").attr("x",25).attr("y",20).text((function(t){return t}));var p=c.selectAll(".legend").data(m.domain()).enter().append("g").attr("transform",(function(t,e){return"translate(".concat(360,",").concat(100+20*e,")")}));return p.append("circle").attr("cx",0).attr("cy",0).attr("r",5).attr("fill",m),p.append("text").attr("x",10).attr("y",5).text((function(t){return t})),o.on("tick",(function(){i.attr("x1",(function(t){return t.source.x})).attr("y1",(function(t){return t.source.y})).attr("x2",(function(t){return t.target.x})).attr("y2",(function(t){return t.target.y})),s.attr("x",(function(t){return t.x-15})).attr("y",(function(t){return t.y-15})),l.attr("x",(function(t){return t.x+15})).attr("y",(function(t){return t.y+5}))})),{destroy:function(){o.stop()},nodes:function(){return c.node()}}},t}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.createGraph()}},{key:"componentDidUpdate",value:function(){h.h("svg").selectAll("*").remove(),this.createGraph()}},{key:"render",value:function(){return console.log(this.props.data),r.a.createElement("svg",null)}}]),a}(r.a.Component),y=function(t){Object(s.a)(a,t);var e=Object(u.a)(a);function a(t){var n;return Object(i.a)(this,a),(n=e.call(this,t)).state={options:[]},n.onChange=n.onChange.bind(Object(p.a)(n)),n}return Object(l.a)(a,[{key:"onChange",value:function(t){var e,a=this.state.options;t.target.checked?(console.log(t.target.value,typeof t.target.value),a.push(t.target.value)):(e=a.indexOf(t.target.value),a.splice(e,1)),this.setState({options:a})}},{key:"render",value:function(){var t=this,e=this.props.nodeData,a=this.props.linksData,n=["pod","node","container"],o=["deployment","pod","service"],c=e.filter((function(e){return t.state.options.includes(e.group)||t.state.options.includes("all")||t.state.options.includes("topology")&&n.includes(e.group)||t.state.options.includes("call graph")&&o.includes(e.group)})),i=c.map((function(t){return t.id})),l=a.filter((function(t){return i.includes(t.source)&&i.includes(t.target)}));c.map((function(t){return r.a.createElement("li",null,t.name)}));return r.a.createElement("div",null,r.a.createElement("form",null,r.a.createElement("label",null,"Pods: ",r.a.createElement("input",{name:"pods",type:"checkbox",value:"pod",onChange:this.onChange})),r.a.createElement("br",null),r.a.createElement("label",null,"Nodes: ",r.a.createElement("input",{name:"nodes",type:"checkbox",value:"node",onChange:this.onChange})),r.a.createElement("br",null),r.a.createElement("label",null,"Containers: ",r.a.createElement("input",{name:"containers",type:"checkbox",value:"container",onChange:this.onChange})),r.a.createElement("br",null),r.a.createElement("label",null,"Services: ",r.a.createElement("input",{name:"services",type:"checkbox",value:"service",onChange:this.onChange})),r.a.createElement("br",null),r.a.createElement("label",null,"Deployments: ",r.a.createElement("input",{name:"deployments",type:"checkbox",value:"deployment",onChange:this.onChange}))),r.a.createElement(f,{height:500,width:500,links:l,nodes:c}))}}]),a}(r.a.Component),g=function(t){Object(s.a)(a,t);var e=Object(u.a)(a);function a(){var t;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))).state={graphData:{nodes:[],edges:[]}},t.fetchData=function(){fetch("/data/graph").then((function(t){return t.json()})).then((function(e){t.setState({graphData:e})})).catch((function(t){console.log(t,"FETCH FAILED!")}))},t}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){return console.log(this.state.graphData.nodes),r.a.createElement("div",{className:"App"},r.a.createElement("button",{onClick:this.fetchTest},"Test data fetching"),r.a.createElement("button",{onClick:this.fetchData},"Refresh Graph Data"),r.a.createElement("header",{className:"App-header"},r.a.createElement(y,{nodeData:this.state.graphData.nodes,linksData:this.state.graphData.edges})))}}]),a}(r.a.Component),b=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,402)).then((function(e){var a=e.getCLS,n=e.getFID,r=e.getFCP,o=e.getLCP,c=e.getTTFB;a(t),n(t),r(t),o(t),c(t)}))},v=a(7),D=function(t){Object(s.a)(a,t);var e=Object(u.a)(a);function a(t){return Object(i.a)(this,a),e.call(this,t)}return Object(l.a)(a,[{key:"render",value:function(){var t;return t=this.props.brush?r.a.createElement(v.a,null):r.a.createElement("div",null),r.a.createElement(v.f,{width:this.props.width,height:this.props.height,data:this.props.data,syncId:this.props.syncID,margin:{top:10,right:30,left:20,bottom:20}},t,r.a.createElement(v.b,{strokeDasharray:"3 3"}),r.a.createElement(v.j,{dataKey:this.props.xDataKey},r.a.createElement(v.c,{value:this.props.xLabel,position:"bottom"})),r.a.createElement(v.k,{dataKey:this.props.yDataKey},r.a.createElement(v.c,{value:this.props.yLabel,angle:-90,position:"left"})),r.a.createElement(v.i,null),r.a.createElement(v.e,{type:"monotone",dataKey:this.props.yDataKey,stroke:"#8884d8",fill:"#8884d8"}))}}]),a}(n.PureComponent),E=a(87),x=a(401),k=(Object(E.a)(x.a).range(),function(t){Object(s.a)(a,t);var e=Object(u.a)(a);function a(t){return Object(i.a)(this,a),e.call(this,t)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement(v.h,{width:this.props.width,height:this.props.height,syncId:this.props.syncID,margin:{top:20,right:20,bottom:20,left:20}},r.a.createElement(v.b,null),r.a.createElement(v.j,{type:"number",dataKey:this.props.xDataKey,name:this.props.xLabel,unit:"s",domain:["dataMin","dataMax"]}),r.a.createElement(v.k,{type:"category",dataKey:this.props.yDataKey,name:this.props.yLabel}),r.a.createElement(v.i,{cursor:{strokeDasharray:"3 3"}}),r.a.createElement(v.g,{name:"Events",data:this.props.data,fill:"#8884d8"}))}}]),a}(n.PureComponent));k.jsfiddleUrl="https://jsfiddle.net/alidingling/9Lfxjjty/";var j=function(t,e,a){return a.indexOf(t)==e},O=function(t){Object(s.a)(a,t);var e=Object(u.a)(a);function a(){var t;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))).state={opsData:[],memoryData:[],eventData:[],latencyData:[],cpuData:[],errorData:[]},t.fetchData=function(){fetch("/data/metric").then((function(t){return t.json()})).then((function(e){t.setState({opsData:e.ops,memoryData:e.memory,eventData:e.event,errorData:e.error,latencyData:e.latency,cpuData:e.cpu})})).catch((function(t){console.log(t,"FETCH FAILED!")}))},t}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"render",value:function(){var t=this.state.memoryData.map((function(t){return t.resource_id})).filter(j);console.log(t);var e=this.state.memoryData.filter((function(t){return"details-v1-6c9f8bcbcb-crqvr/details"==t.resource_id}));for(var a in e)e[a].memory=parseInt(e[a].memory);var n=this.state.memoryData.filter((function(t){return"productpage-v1-7df7cb7f86-5pdhd/productpage"==t.resource_id}));for(var a in n)n[a].memory=parseInt(n[a].memory);return r.a.createElement("div",null,r.a.createElement("button",{onClick:this.fetchData},"Refresh Metric Data"),r.a.createElement("h4",null,"Metric Plots"),r.a.createElement(k,{data:this.state.eventData,width:500,height:200,syncID:"anyID",xDataKey:"time",yDataKey:"reason",xLabel:"time",yLabel:"Event Type",brush:!1}),r.a.createElement(D,{data:this.state.opsData,width:500,height:200,syncID:"anyID",xDataKey:"time",yDataKey:"ops",xLabel:"time",yLabel:"Ops/s",brush:!0}),r.a.createElement(D,{data:this.state.cpuData,width:500,height:200,syncID:"anyID",xDataKey:"time",yDataKey:"cpu",xLabel:"time",yLabel:"cpu",brush:!1}),r.a.createElement(D,{data:this.state.latencyData,width:500,height:200,syncID:"anyID",xDataKey:"time",yDataKey:"lat",xLabel:"time",yLabel:"latency",brush:!1}),r.a.createElement(D,{data:this.state.errorData,width:500,height:200,syncID:"anyID",xDataKey:"time",yDataKey:"success",xLabel:"time",yLabel:"Success rate",brush:!1}),r.a.createElement(v.f,{width:600,height:300,syncId:"anyId",margin:{top:10,right:30,left:20,bottom:20}},r.a.createElement(v.b,{strokeDasharray:"3 3"}),r.a.createElement(v.j,{dataKey:"time"},r.a.createElement(v.c,{value:"time",position:"bottom"})),r.a.createElement(v.k,null),r.a.createElement(v.i,null),r.a.createElement(v.d,null),r.a.createElement(v.e,{data:e,type:"monotone",dataKey:"memory",stroke:"#8884d8",activeDot:{r:8}}),r.a.createElement(v.e,{data:n,type:"monotone",dataKey:"memory",stroke:"#82ca9d"})))}}]),a}(n.PureComponent);O.jsfiddleUrl="https://jsfiddle.net/alidingling/nskpgcrz/";var w=O;c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(g,null)),document.getElementById("root")),c.a.render(r.a.createElement(w,null),document.getElementById("rechart")),b()}},[[399,1,2]]]);
//# sourceMappingURL=main.73cd4442.chunk.js.map