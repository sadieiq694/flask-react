(this["webpackJsonpreact-frontend"]=this["webpackJsonpreact-frontend"]||[]).push([[0],{222:function(e,t,a){},401:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(42),c=a.n(o),s=(a(222),a(17)),i=a.n(s),l=a(59),u=a(11),p=a(12),d=a(14),h=a(13),m=a(60),f=a(9),y=f.g().domain(["node","container","pod","service","deployment"]).range(["https://cdn2.iconfinder.com/data/icons/mixd/512/21_kubernetes-512.png","https://cdn4.iconfinder.com/data/icons/vectory-symbols/40/hexagon-512.png","https://image.flaticon.com/icons/svg/73/73326.svg","https://static.thenounproject.com/png/32460-200.png","https://cdn1.iconfinder.com/data/icons/materia-arrows-symbols-vol-9/24/018_343_insignia_badge_shape_triangle-512.png"]),g=f.g().domain(["scheduled on","runs","references","targets","calls","owns","backs","points to"]).range(["red","black","blue","pink","green","brown","yellow","orange"]),b=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).createGraph=function(){var t=1e3,a=e.props.links.map((function(e){return Object.assign({},e)})),n=e.props.nodes.map((function(e){return Object.assign({},e)})),r=function(e){return f.a().subject((function(t){return e.find(t.x,t.y)})).on("start",(function(t){t.active||e.alphaTarget(.3).restart(),t.subject.fx=t.subject.x,t.subject.fy=t.subject.y})).on("drag",(function(e){e.subject.fx=e.x,e.subject.fy=e.y})).on("end",(function(t){t.active||e.alphaTarget(0),t.subject.fx=null,t.subject.fy=null}))},o=f.d(n).force("link",f.b(a).id((function(e){return e.id}))).force("charge",f.c().strength(-200)).force("x",f.e()).force("y",f.f()),c=f.h("svg").attr("viewBox",[-500,-200,t,400]),s=(c.append("defs").append("marker").attr("id","arrowhead").attr("viewBox","-0 -5 10 10").attr("refX",23).attr("refY",0).attr("orient","auto").attr("markerWidth",4).attr("markerHeight",4).attr("xoverflow","visible").append("svg:path").attr("d","M 0,-5 L 10 ,0 L 0,5").attr("fill","black").style("stroke","none"),c.append("g").attr("stroke","#999").attr("stroke-opacity",.6).selectAll("line").data(a).join("line").style("stroke",(function(e){return g(e.type)})).attr("stroke-width",3).attr("marker-end","url(#arrowhead)")),i=c.append("g").attr("class","text").selectAll("text").data(n).enter().append("text").attr("font-family","sans-serif").attr("font-size",15).text((function(e){return e.name})).call(r(o)),l=c.append("g").attr("class","image").selectAll("image").data(n).enter().append("image").attr("xlink:href",(function(e){return y(e.group)})).attr("width",30).attr("height",30).call(r(o)),u=c.selectAll(".legend").data(y.domain()).enter().append("g").attr("transform",(function(e,t){return"translate(".concat(350,",").concat(25*t-50,")")}));u.append("image").attr("xlink:href",y).attr("width",20).attr("height",20),u.append("text").attr("x",25).attr("y",20).text((function(e){return e}));var p=c.selectAll(".legend").data(g.domain()).enter().append("g").attr("transform",(function(e,t){return"translate(".concat(360,",").concat(100+20*t,")")}));return p.append("circle").attr("cx",0).attr("cy",0).attr("r",5).attr("fill",g),p.append("text").attr("x",10).attr("y",5).text((function(e){return e})),o.on("tick",(function(){s.attr("x1",(function(e){return e.source.x})).attr("y1",(function(e){return e.source.y})).attr("x2",(function(e){return e.target.x})).attr("y2",(function(e){return e.target.y})),l.attr("x",(function(e){return e.x-15})).attr("y",(function(e){return e.y-15})),i.attr("x",(function(e){return e.x+15})).attr("y",(function(e){return e.y+5}))})),{destroy:function(){o.stop()},nodes:function(){return c.node()}}},e}return Object(p.a)(a,[{key:"componentDidMount",value:function(){this.createGraph()}},{key:"componentDidUpdate",value:function(){f.h("svg").selectAll("*").remove(),this.createGraph()}},{key:"render",value:function(){return console.log(this.props.data),r.a.createElement("svg",null)}}]),a}(r.a.Component),v=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).state={options:[]},n.onChange=n.onChange.bind(Object(m.a)(n)),n}return Object(p.a)(a,[{key:"onChange",value:function(e){var t,a=this.state.options;e.target.checked?(console.log(e.target.value,typeof e.target.value),a.push(e.target.value)):(t=a.indexOf(e.target.value),a.splice(t,1)),this.setState({options:a})}},{key:"render",value:function(){var e=this,t=this.props.nodeData,a=this.props.linksData,n=["pod","node","container"],o=["deployment","pod","service"],c=t.filter((function(t){return e.state.options.includes(t.group)||e.state.options.includes("all")||e.state.options.includes("topology")&&n.includes(t.group)||e.state.options.includes("call graph")&&o.includes(t.group)})),s=c.map((function(e){return e.id})),i=a.filter((function(e){return s.includes(e.source)&&s.includes(e.target)}));c.map((function(e){return r.a.createElement("li",null,e.name)}));return r.a.createElement("div",null,r.a.createElement("form",null,r.a.createElement("label",null,"Pods: ",r.a.createElement("input",{name:"pods",type:"checkbox",value:"pod",onChange:this.onChange})),r.a.createElement("br",null),r.a.createElement("label",null,"Nodes: ",r.a.createElement("input",{name:"nodes",type:"checkbox",value:"node",onChange:this.onChange})),r.a.createElement("br",null),r.a.createElement("label",null,"Containers: ",r.a.createElement("input",{name:"containers",type:"checkbox",value:"container",onChange:this.onChange})),r.a.createElement("br",null),r.a.createElement("label",null,"Services: ",r.a.createElement("input",{name:"services",type:"checkbox",value:"service",onChange:this.onChange})),r.a.createElement("br",null),r.a.createElement("label",null,"Deployments: ",r.a.createElement("input",{name:"deployments",type:"checkbox",value:"deployment",onChange:this.onChange}))),r.a.createElement(b,{height:500,width:500,links:i,nodes:c}))}}]),a}(r.a.Component),D=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={graphData:{nodes:[],edges:[]}},e}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=Object(l.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/data/graph");case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,this.setState({graphData:a}),console.log("graph data: ",this.state.graphData);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return console.log(this.state.graphData.nodes),r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(v,{nodeData:this.state.graphData.nodes,linksData:this.state.graphData.edges})))}}]),a}(r.a.Component),x=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,403)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),o(e),c(e)}))},E=a(7),k=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){return Object(u.a)(this,a),t.call(this,e)}return Object(p.a)(a,[{key:"render",value:function(){var e;return e=this.props.brush?r.a.createElement(E.a,null):r.a.createElement("div",null),r.a.createElement(E.f,{width:this.props.width,height:this.props.height,data:this.props.data,syncId:this.props.syncID,margin:{top:10,right:30,left:20,bottom:20}},e,r.a.createElement(E.b,{strokeDasharray:"3 3"}),r.a.createElement(E.h,{dataKey:this.props.xDataKey},r.a.createElement(E.c,{value:this.props.xLabel,position:"bottom"})),r.a.createElement(E.i,{dataKey:this.props.yDataKey},r.a.createElement(E.c,{value:this.props.yLabel,angle:-90,position:"left"})),r.a.createElement(E.g,null),r.a.createElement(E.e,{type:"monotone",dataKey:this.props.yDataKey,stroke:"#8884d8",fill:"#8884d8"}))}}]),a}(n.PureComponent),j=function(e,t,a){return a.indexOf(e)==t},w=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={opsData:[],memoryData:[],eventData:[],latencyData:[],cpuData:[],errorData:[]},e}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=Object(l.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/data/metric");case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,this.setState({opsData:a.ops,memoryData:a.memory,eventData:a.event,errorData:a.error,latencyData:a.latency,cpuData:a.cpu}),console.log("graph data: ",this.state.opsData);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.memoryData.map((function(e){return e.resource_id})).filter(j);console.log(e);var t=this.state.memoryData.filter((function(e){return"details-v1-6c9f8bcbcb-crqvr/details"==e.resource_id}));for(var a in t)t[a].memory=parseInt(t[a].memory);var n=this.state.memoryData.filter((function(e){return"productpage-v1-7df7cb7f86-5pdhd/productpage"==e.resource_id}));for(var a in n)n[a].memory=parseInt(n[a].memory);return r.a.createElement("div",null,r.a.createElement("h4",null,"Metric Plots"),r.a.createElement(k,{data:this.state.opsData,width:500,height:200,syncID:"anyID",xDataKey:"time",yDataKey:"ops",xLabel:"time",yLabel:"Ops/s",brush:!0}),r.a.createElement(k,{data:this.state.cpuData,width:500,height:200,syncID:"anyID",xDataKey:"time",yDataKey:"cpu",xLabel:"time",yLabel:"cpu",brush:!1}),r.a.createElement(k,{data:this.state.latencyData,width:500,height:200,syncID:"anyID",xDataKey:"time",yDataKey:"lat",xLabel:"time",yLabel:"latency",brush:!1}),r.a.createElement(k,{data:this.state.errorData,width:500,height:200,syncID:"anyID",xDataKey:"time",yDataKey:"success",xLabel:"time",yLabel:"Success rate",brush:!1}),r.a.createElement(E.f,{width:600,height:300,syncId:"anyId",margin:{top:10,right:30,left:20,bottom:20}},r.a.createElement(E.b,{strokeDasharray:"3 3"}),r.a.createElement(E.h,{dataKey:"time"},r.a.createElement(E.c,{value:"time",position:"bottom"})),r.a.createElement(E.i,null),r.a.createElement(E.g,null),r.a.createElement(E.d,null),r.a.createElement(E.e,{data:t,type:"monotone",dataKey:"memory",stroke:"#8884d8",activeDot:{r:8}}),r.a.createElement(E.e,{data:n,type:"monotone",dataKey:"memory",stroke:"#82ca9d"})))}}]),a}(n.PureComponent);w.jsfiddleUrl="https://jsfiddle.net/alidingling/nskpgcrz/";var O=w;c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(D,null)),document.getElementById("root")),c.a.render(r.a.createElement(O,null),document.getElementById("rechart")),x()}},[[401,1,2]]]);
//# sourceMappingURL=main.c345b873.chunk.js.map